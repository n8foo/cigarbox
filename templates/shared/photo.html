{% extends "layout.html" %}

{# Set Open Graph variables for social media preview #}
{% set og_image = photo.uri %}
{% set og_title = 'Shared Photo' %}
{% set og_url = request.url %}
{% set tag_list = tags | list %}
{% if photo.datetaken %}
{% set og_description = 'Photo taken on ' + (photo.datetaken | format_datetime('%Y-%m-%d')) %}
{% set og_image_alt = 'Photo from ' + (photo.datetaken | format_datetime('%Y-%m-%d')) %}
{% else %}
{% set og_description = 'A shared photo from CigarBox' %}
{% set og_image_alt = 'Shared photo' %}
{% endif %}

{% block body %}

<div class="container">
  <!-- Header -->
  <div class="row" style="margin-bottom: 15px;">
    <div class="col-md-12">
      {% if photo.datetaken %}
      <p class="text-muted" style="font-size: 14px;">
        <span class="bi bi-calendar"></span> {{ photo.datetaken | format_datetime }}
      </p>
      {% endif %}
    </div>
  </div>

  <!-- Tags -->
  {% if tag_list %}
  <div class="row">
    <div class="col-md-12">
      <div style="padding: 12px 15px; background-color: var(--bs-secondary-bg); border-radius: 4px; margin-bottom: 10px;">
        <p class="text-muted" style="margin: 0; font-size: 14px;">
          <span class="bi bi-tag"></span> <strong>Tags:</strong>
          {% for tag in tag_list %}
          <span class="badge bg-secondary" style="margin-left: 5px; margin-bottom: 3px;">{{ tag.name }}</span>
          {% endfor %}
        </p>
      </div>
    </div>
  </div>
  {% endif %}
  <hr>

  <!-- Photo Display -->
  <div class="row">
    <div class="col-md-12">
      <div style="position: relative; text-align: center;">
        <img class='img-fluid' style="width: 100%; max-height: 85vh; object-fit: contain;"
             src="{{ signed_s3_url(photo.uri, '_b') }}" alt="Shared photo">
        {% if share_token.allow_download %}
        <a href="{{SITEURL}}/shared/{{ share_token.token }}/download"
           style="position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; padding: 10px 15px; border-radius: 4px; text-decoration: none;">
          <span class="bi bi-download"></span> Download Original
        </a>
        {% endif %}
      </div>
    </div>
  </div>
</div>
<br><br>

{% endblock %}
