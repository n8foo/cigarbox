{% extends "layout.html" %}
{% block body %}

<div class="row">
  <div class="col-md-12">
    <h1>Edit Photo #{{ photo.id }}</h1>
    <hr>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <!-- Photo Preview -->
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Preview</h3>
      </div>
      <div class="panel-body text-center">
        <img src="http://s3.amazonaws.com/{{ config['S3_BUCKET_NAME'] }}/{{ photo.uri }}_c.jpg" alt="Photo {{ photo.id }}" class="img-responsive" style="max-width: 100%;">
        <br>
        <a href="{{SITEURL}}/photos/{{ photo.id }}" class="btn btn-primary">View Full Size</a>
      </div>
    </div>

    <!-- Photo Info -->
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Photo Information</h3>
      </div>
      <div class="panel-body">
        <dl class="dl-horizontal">
          <dt>ID:</dt>
          <dd>{{ photo.id }}</dd>
          <dt>SHA1:</dt>
          <dd><small>{{ photo.sha1 }}</small></dd>
          <dt>File Type:</dt>
          <dd>{{ photo.filetype }}</dd>
          <dt>Uploaded:</dt>
          <dd>{{ photo.ts.strftime('%Y-%m-%d %H:%M:%S') }}</dd>
        </dl>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <!-- Edit Form -->
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Edit Metadata</h3>
      </div>
      <div class="panel-body">
        <form method="POST" action="{{SITEURL}}/admin/photos/{{ photo.id }}/edit">
          <!-- Privacy -->
          <div class="form-group">
            <label for="privacy">Privacy Level</label>
            <select name="privacy" id="privacy" class="form-control">
              <option value="null" {% if photo.privacy is none %}selected{% endif %}>Public (Default)</option>
              <option value="0" {% if photo.privacy == 0 %}selected{% endif %}>Public</option>
              <option value="1" {% if photo.privacy == 1 %}selected{% endif %}>Friends</option>
              <option value="2" {% if photo.privacy == 2 %}selected{% endif %}>Family</option>
              <option value="3" {% if photo.privacy == 3 %}selected{% endif %}>Private</option>
            </select>
          </div>

          <!-- Date Taken -->
          <div class="form-group">
            <label for="datetaken">Date Taken</label>
            <input type="text" name="datetaken" id="datetaken" class="form-control"
                   value="{{ (photo.datetaken | format_datetime('%Y-%m-%d %H:%M:%S')) if photo.datetaken else '' }}"
                   placeholder="YYYY-MM-DD HH:MM:SS">
            <p class="help-block">Format: YYYY-MM-DD HH:MM:SS</p>
          </div>

          <!-- Tags -->
          <div class="form-group">
            <label for="tags">Tags</label>
            <input type="text" name="tags" id="tags" class="form-control"
                   value="{{ tag_names }}"
                   placeholder="tag1, tag2, tag3">
            <p class="help-block">Comma-separated list of tags</p>
          </div>

          <div class="form-group">
            <button type="submit" class="btn btn-primary">Save Changes</button>
            <a href="{{SITEURL}}/admin/photos" class="btn btn-secondary">Cancel</a>
            <a href="{{SITEURL}}/photos/{{ photo.id }}/delete" class="btn btn-danger float-end"
               onclick="return confirm('Are you sure you want to delete this photo?');">Delete Photo</a>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

{% endblock %}
